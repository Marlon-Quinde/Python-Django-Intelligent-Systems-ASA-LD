{% extends 'layout/sidebar.html' %}

{% load static %}

{% block title %}Análisis Neutrosófico{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="bg-white rounded-lg shadow-lg p-6">
        <h1 class="text-3xl font-bold text-gray-800 mb-6">Análisis Neutrosófico</h1>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Análisis de Profesores -->
            <div class="bg-blue-50 rounded-lg p-6">
                <h2 class="text-xl font-semibold text-blue-800 mb-4">Análisis de Profesores</h2>
                <div class="mb-4">
                    <label for="profesor_id" class="block text-sm font-medium text-gray-700 mb-2">
                        Seleccionar Profesor:
                    </label>
                    <select id="profesor_id" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">Seleccione un profesor...</option>
                    </select>
                </div>
                <button id="analizar_profesor" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors">
                    Analizar Profesor
                </button>
                <div id="resultados_profesor" class="mt-4"></div>
            </div>

            <!-- Análisis de Estudiantes -->
            <div class="bg-green-50 rounded-lg p-6">
                <h2 class="text-xl font-semibold text-green-800 mb-4">Análisis de Estudiantes</h2>
                <button id="analizar_estudiantes" class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors">
                    Analizar Estudiantes
                </button>
                <div id="resultados_estudiantes" class="mt-4"></div>
            </div>
        </div>

        <!-- Explicación del Análisis Neutrosófico -->
        <div class="mt-8 bg-gray-50 rounded-lg p-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-3">¿Qué es el Análisis Neutrosófico?</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600">
                <div>
                    <h4 class="font-medium text-blue-600 mb-2">T (Verdad)</h4>
                    <p>Representa el grado de verdad o certeza en la evaluación. Un valor alto indica mayor confianza en la competencia del docente.</p>
                </div>
                <div>
                    <h4 class="font-medium text-yellow-600 mb-2">I (Indeterminación)</h4>
                    <p>Representa el grado de incertidumbre o ambigüedad. Un valor alto indica mayor variabilidad en las evaluaciones.</p>
                </div>
                <div>
                    <h4 class="font-medium text-red-600 mb-2">F (Falsedad)</h4>
                    <p>Representa el grado de falsedad o negación. Un valor alto indica menor competencia percibida.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Cargar lista de profesores
    cargarProfesores();
    
    // Event listeners
    document.getElementById('analizar_profesor').addEventListener('click', analizarProfesor);
    document.getElementById('analizar_estudiantes').addEventListener('click', analizarEstudiantes);
});

function cargarProfesores() {
    // Aquí deberías hacer una llamada AJAX para obtener la lista de profesores
    // Por ahora, usaremos un ejemplo estático
    const select = document.getElementById('profesor_id');
    // Agregar opciones de ejemplo
    const profesores = [
        {id: 1, nombre: 'Profesor 1'},
        {id: 2, nombre: 'Profesor 2'},
        {id: 3, nombre: 'Profesor 3'}
    ];
    
    profesores.forEach(profesor => {
        const option = document.createElement('option');
        option.value = profesor.id;
        option.textContent = profesor.nombre;
        select.appendChild(option);
    });
}

function analizarProfesor() {
    const profesorId = document.getElementById('profesor_id').value;
    if (!profesorId) {
        alert('Por favor seleccione un profesor');
        return;
    }
    
    fetch(`/neutro/profesores/?id=${profesorId}`)
        .then(response => response.json())
        .then(data => {
            mostrarResultadosProfesor(data);
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Error al analizar el profesor');
        });
}

function analizarEstudiantes() {
    fetch('/neutro/estudiantes/')
        .then(response => response.json())
        .then(data => {
            mostrarResultadosEstudiantes(data);
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Error al analizar los estudiantes');
        });
}

function mostrarResultadosProfesor(data) {
    const container = document.getElementById('resultados_profesor');
    container.innerHTML = '';
    
    if (data.length === 0) {
        container.innerHTML = '<p class="text-gray-500">No hay datos disponibles</p>';
        return;
    }
    
    const table = document.createElement('table');
    table.className = 'w-full text-sm';
    table.innerHTML = `
        <thead>
            <tr class="bg-blue-100">
                <th class="px-2 py-1 text-left">Materia</th>
                <th class="px-2 py-1 text-center">T</th>
                <th class="px-2 py-1 text-center">I</th>
                <th class="px-2 py-1 text-center">F</th>
                <th class="px-2 py-1 text-center">Score</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    `;
    
    const tbody = table.querySelector('tbody');
    data.forEach(item => {
        const row = document.createElement('tr');
        row.className = 'border-b border-gray-200';
        row.innerHTML = `
            <td class="px-2 py-1">${item.materia}</td>
            <td class="px-2 py-1 text-center text-blue-600 font-medium">${item.T}</td>
            <td class="px-2 py-1 text-center text-yellow-600 font-medium">${item.I}</td>
            <td class="px-2 py-1 text-center text-red-600 font-medium">${item.F}</td>
            <td class="px-2 py-1 text-center font-bold">${item.score}</td>
        `;
        tbody.appendChild(row);
    });
    
    container.appendChild(table);
}

function mostrarResultadosEstudiantes(data) {
    const container = document.getElementById('resultados_estudiantes');
    container.innerHTML = '';
    
    if (data.length === 0) {
        container.innerHTML = '<p class="text-gray-500">No hay datos disponibles</p>';
        return;
    }
    
    const table = document.createElement('table');
    table.className = 'w-full text-sm';
    table.innerHTML = `
        <thead>
            <tr class="bg-green-100">
                <th class="px-2 py-1 text-left">Profesor</th>
                <th class="px-2 py-1 text-left">Materia</th>
                <th class="px-2 py-1 text-center">T</th>
                <th class="px-2 py-1 text-center">I</th>
                <th class="px-2 py-1 text-center">F</th>
                <th class="px-2 py-1 text-center">Score</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    `;
    
    const tbody = table.querySelector('tbody');
    data.forEach(item => {
        const row = document.createElement('tr');
        row.className = 'border-b border-gray-200';
        row.innerHTML = `
            <td class="px-2 py-1">${item.profesor}</td>
            <td class="px-2 py-1">${item.materia}</td>
            <td class="px-2 py-1 text-center text-blue-600 font-medium">${item.T}</td>
            <td class="px-2 py-1 text-center text-yellow-600 font-medium">${item.I}</td>
            <td class="px-2 py-1 text-center text-red-600 font-medium">${item.F}</td>
            <td class="px-2 py-1 text-center font-bold">${item.score}</td>
        `;
        tbody.appendChild(row);
    });
    
    container.appendChild(table);
}
</script>
{% endblock %} 